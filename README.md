# cognicity-alerts
Geospatial Alerting of Crowd-sourced Hazard Reports

System Overview
---------------
System is comprised of following components:
- SCHEMA in cognicity-schema PostgreSQL database (alerts.locations & alerts.users)
  - trigger performs spatial query using PostGIS extension to detect when new hazard reports are within specified distance of pre-registered alerting locations
  - issues alert using PostgreSQL NOTIFY
  - if multiple alerting locations are within range of new report, multiple NOTIFY alerts are issued
  - alerts schema maintains a log of activity for each alert location as a JSONB object in the alerts.locations table
  - note that NOTIFY payloads are max of 8000 bytes. Thus, long logs will be truncated
- MODULE in cogncity-notification service
  - receives NOTIFY alerts from database and processes to issue Amazon Web Services SNS notification
- COMPUTE
  - TODO
  - determines what to tell the user based on range to new report and log history at alert location
- REPLY LAMBDAS
  - Listen for response generated by COMPUTE and send to user via appropriate social network
  - SERVER
    - CRUD endpoint /alerts
      - register new users + alert locations
      - add new alert locations
      - append new log Information
      - un-subscribe users

Information Flow
----------------

### Register user
HTTP POST -> SERVER /alerts -> DATABASE

### Issue Alert
NEW REPORT -> DATABASE (alerts schema) -> COGNICITY-NOTIFICATION -> SNS -> COMPUTE -> REPLY LAMBDAS
